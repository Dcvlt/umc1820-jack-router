# mosquitto/config/mosquitto.conf
# Mosquitto MQTT Broker Configuration for JACK Audio Router

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# Default MQTT port
listener 1883
allow_anonymous true

# WebSocket support for web clients
listener 9001
protocol websockets
allow_anonymous true

# Bind to all interfaces (Docker networking)
bind_address 0.0.0.0

# =============================================================================
# PERSISTENCE CONFIGURATION
# =============================================================================

# Enable persistence
persistence true
persistence_location /mosquitto/data/

# Auto save interval (seconds)
autosave_interval 1800

# Retained message storage
persistence_file mosquitto.db

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log destinations
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout

# Log types
log_type error
log_type warning
log_type notice
log_type information

# Log additional information
connection_messages true
log_timestamp true

# =============================================================================
# MQTT PROTOCOL CONFIGURATION
# =============================================================================

# Maximum packet size (bytes)
message_size_limit 0

# Keep alive
keepalive_interval 60

# Maximum connections
max_connections -1

# =============================================================================
# HOME ASSISTANT INTEGRATION
# =============================================================================

# Enable retained messages for Home Assistant discovery
retain_available true

# QoS settings
max_queued_messages 1000
max_inflight_messages 20

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# For development - allow anonymous access
# For production, you should configure authentication:
# password_file /mosquitto/config/passwd
# acl_file /mosquitto/config/acl

# =============================================================================
# BRIDGE CONFIGURATION (if needed for external MQTT)
# =============================================================================

# Uncomment and configure if you need to bridge to another MQTT broker
# connection external-broker
# address external-mqtt-broker.com:1883
# topic # out 0
# topic # in 0